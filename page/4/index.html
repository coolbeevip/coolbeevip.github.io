<!doctype html><html lang=en data-theme><head>
<title> Lei Zhang </title>
<meta charset=utf-8><meta name=generator content="Hugo 0.92.2"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name=description content="This is my knowledge base. I document things here">
<link rel=stylesheet href=/css/style.min.7cf3c5090ac13256a5fa5531e5649cfe5a2ba7de88dca14ce0b6e253409a3511.css integrity="sha256-fPPFCQrBMlal+lUx5WSc/lorp96I3KFM4LbiU0CaNRE=" crossorigin=anonymous type=text/css>
<link rel=stylesheet href=/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS+yuWSR4=" crossorigin=anonymous type=text/css>
<link rel=stylesheet href=/css/custom.min.3fa691134fafa8351e9d193939a352647c1ae886828bdefa3f5a272653dbf7e4.css integrity="sha256-P6aRE0+vqDUenRk5OaNSZHwa6IaCi976P1onJlPb9+Q=" crossorigin=anonymous media=screen>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin=anonymous>
<link rel="shortcut icon" href=/favicons/favicon.ico type=image/x-icon>
<link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png>
<link rel=canonical href=/>
<link rel=alternate type=application/rss+xml href=/index.xml title>
<script type=text/javascript src=/js/anatole-header.min.0c05c0a90d28c968a1cad4fb31abd0b8e1264e788ccefed022ae1d3b6f627514.js integrity="sha256-DAXAqQ0oyWihytT7MavQuOEmTniMzv7QIq4dO29idRQ=" crossorigin=anonymous></script>
<meta name=twitter:card content="summary">
<meta name=twitter:title content>
<meta name=twitter:description content="This is my knowledge base. I document things here">
</head>
<body><div class="sidebar .">
<div class=logo-title>
<div class=title>
<img src=/images/profile.jpg alt="profile picture">
<h3 title><a href=/>I'm Lei Zhang</a></h3>
<div class=description>
<p>This is my knowledge base. I document things here</p>
</div>
</div>
<p>
<a href=https://github.com/coolbeevip><img src="https://img.shields.io/github/followers/coolbeevip?label=follow&style=social" alt="GitHub coolbeevip"></a>
<img src=https://badges.pufler.dev/commits/all/coolbeevip alt="Commits Badge">
<img src=https://badges.pufler.dev/repos/coolbeevip alt="Repos Badge">
<img src=https://badges.pufler.dev/years/coolbeevip alt="Years Badge">
</p>
</div>
<ul class=social-links>
<li>
<a href=https://github.com/coolbeevip/ rel=me aria-label=GitHub>
<i class="fab fa-github fa-2x" aria-hidden=true></i>
</a>
</li>
<li>
<a href=mailto:zhanglei@apache.org rel=me aria-label=e-mail>
<i class="fas fa-envelope fa-2x" aria-hidden=true></i>
</a>
</li>
</ul>
<div class=footer>
<div class=by_farbox>&copy; Lei Zhang 2022 </div>
</div>
</div>
<div class=main>
<div class="page-top .">
<a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false>
<span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span>
</a>
<ul class=nav id=navMenu>
<li><a class=current href=/ title>Home</a></li>
<li><a href=/posts title>Blog</a></li>
<li><a href=/bookmarks title>Bookmarks</a></li>
<li><a href=/about/ title>About</a></li>
</ul>
</div>
<div class=autopagerize_page_element>
<div class=content>
<div class="post .">
</div>
<div class="post .">
<div class=post-title>
<h3><a href=/posts/maven/maven-best-practices-for-structuring-projects-and-modules/>Maven Projects Best Practices</a>
</h3>
</div>
<div class=post-content>
<div class=p_part>
<p>本文整理构建Maven项目和模块的最佳实践的关键事项，其中包含依赖、版本、属性、模块划分等关键因素，推荐使用 Maven 3.6.3 及以上版本。 为了便于理解，我们假设有一个 API 网关项目，这个网关项目包含服务端、客户端、通知服务端支持插件。
目标 通过多模块方式组织项目 管理项目版本、依赖，属性 规划模块依赖关系 主项目 POM 每个项目都应该在项目根目录下有一个主 POM 文件，并通过主 POM 文件管理下级子模块。在主 POM 中至少会使用一下标签
properties: 定义字符集编码、JDK 版本、插件版本; modules: 下级子模块; pluginRepositories: 插件仓库地址（非必须，主要解决国内访问慢的问题）; repositories: 定义 Maven 私服地址; distributionManagement: 定义发布用 Maven 私服地址 pluginManagement: 定义管理类插件版本 例如：
&lt;?xml version="1.0" encoding="UTF-8"?> &lt;build xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"> &lt;modelVersion>4.0.0&lt;/modelVersion> &lt;groupId>com.coolbeevip.apigateway&lt;/groupId> &lt;artifactId>apigateway-parent&lt;/artifactId> &lt;version>1.0.0-SNAPSHOT&lt;/version> &lt;packaging>pom&lt;/packaging> &lt;properties> &lt;!-- project --> &lt;project.build.sourceEncoding>UTF-8&lt;/project.build.sourceEncoding> &lt;project.reporting.outputEncoding>UTF-8&lt;/project.reporting.outputEncoding> &lt;maven.compiler.encoding>UTF-8&lt;/maven.compiler.encoding> &lt;maven.compiler.source>8&lt;/maven.compiler.source> &lt;maven.compiler.target>8&lt;/maven.compiler.target> &lt;!-- plugins version --> &lt;maven-compiler-plugin.version>3.1&lt;/maven-compiler-plugin.version> &lt;jacoco-maven-plugin.version>0.8.6&lt;/jacoco-maven-plugin.version> &lt;docker-maven-plugin.</p>
<a href=/posts/maven/maven-best-practices-for-structuring-projects-and-modules/ class=read_more>Read more</a></div>
</div>
<div class=post-footer>
<div class=meta>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date> Sat, May 2, 2020
</span>
<span class=separator><a class=category href=/categories/java/>java</a></span>
<span class=separator><a class=tag href=/tags/maven/>maven</a><a class=tag href=/tags/java/>java</a><a class=tag href=/tags/project/>project</a></span>
</div>
</div>
</div>
</div>
<div class="post .">
<div class=post-title>
<h3><a href=/posts/git/git-command-commit-squash/>Git Squash Commits</a>
</h3>
</div>
<div class=post-content>
<div class=p_part>
<p>压缩合并 Commits，将多个 commit 整理合并的方法，这样可以使提交记录更加清晰
查看提交记录，选择你要合并的范围 git log commit 6d757f70af289b5a90d00bd5e4b93d892d64a258 (HEAD -> SCB-1669) Author: Lei Zhang &lt;zhanglei@apache.org> Date: Thu Dec 19 13:53:26 2019 +0800 SCB-1669 Fixed reverse compensation sort bug in FSM commit 37e0c5d99d0e6dae188cbd78f543ba69433b928f (origin/SCB-1669) Author: Lei Zhang &lt;zhanglei@apache.org> Date: Thu Dec 19 02:00:20 2019 +0800 SCB-1669 Fixed Reverse compensation sort bug in FSM commit b4ea8717a86d1eba1956d21727d05c466ff6d8a2 (upstream/master, origin/master, origin/HEAD, master) Author: Lei Zhang &lt;zhanglei@apache.org> Date: Tue Dec 10 16:25:48 2019 +0800 SCB-1658 Improve encapsulation on txEntityMap of SagaData 可以看到最后两次提交，都是为了修复 SCB-1669 这个问题，此时我想合并最后两次提交 6d757f70af289b5a90d00bd5e4b93d892d64a258 和 37e0c5d99d0e6dae188cbd78f543ba69433b928f</p>
<a href=/posts/git/git-command-commit-squash/ class=read_more>Read more</a></div>
</div>
<div class=post-footer>
<div class=meta>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date> Mon, Apr 6, 2020
</span>
<span class=separator><a class=category href=/categories/git/>git</a></span>
<span class=separator><a class=tag href=/tags/git/>git</a></span>
</div>
</div>
</div>
</div>
<div class="post .">
<div class=post-title>
<h3><a href=/posts/git/git-command-commit-stash/>Git Stash</a>
</h3>
</div>
<div class=post-content>
<div class=p_part>
<p>你在当前分支上开发代码，此时不想 commit，但是又想切换到其他分支完成其他的工作，此时可以用 stash
在当前分支执行 stash 将当前分支未提交的代码隐藏起来 $ git stash Saved working directory and index state WIP on SCB-1577: 2554be3d SCB-1593 Add notice for Boringssl support ciphers (base) bogon:servicecomb-pack zhanglei$ 此时你可以看到已经存储到一个id为 2554be3d 里了，这时你可以用 git status 查看已经没有要提交的内容了
git status On branch SCB-1577 nothing to commit, working tree clean (base) bogon:servicecomb-pack zhanglei$ 这时你就可以切换到其他分支开始新的工作 (base) bogon:servicecomb-pack zhanglei$ git checkout master Switched to branch 'master' Your branch is up to date with 'origin/master'.</p>
<a href=/posts/git/git-command-commit-stash/ class=read_more>Read more</a></div>
</div>
<div class=post-footer>
<div class=meta>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date> Mon, Apr 6, 2020
</span>
<span class=separator><a class=category href=/categories/git/>git</a></span>
<span class=separator><a class=tag href=/tags/git/>git</a></span>
</div>
</div>
</div>
</div>
<div class="post .">
<div class=post-title>
<h3><a href=/posts/git/git-command-rebase-upstream/>Synchronizing Your Forked Git Project</a>
</h3>
</div>
<div class=post-content>
<div class=p_part>
<p>当你 fork 一个仓库后，可以时用此方法使你 fork 后的仓库 master 分支保持和上游 master 分支的同步
使用 rebase 命令同步上游 master 分支到你本地的 master 分支，并推送到你 fork 后的仓库
git fetch upstream git checkout master git rebase upstream/master git push -f origin master 或者你确定放弃你本地所有的修改，则可以简单的重置为上游版本
git fetch upstream git checkout master git reset --hard upstream/master git push -f origin master 如果你也想同步 master 分支的修改到你的功能分支
git checkout &lt;分支名> git rebase master git push -f origin &lt;分支名> </p>
</div>
</div>
<div class=post-footer>
<div class=meta>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date> Mon, Apr 6, 2020
</span>
<span class=separator><a class=category href=/categories/git/>git</a></span>
<span class=separator><a class=tag href=/tags/git/>git</a></span>
</div>
</div>
</div>
</div>
<div class="post .">
<div class=post-title>
<h3><a href=/posts/linux/linux-commands-network/>Linux Command - Network</a>
</h3>
</div>
<div class=post-content>
<div class=p_part>
<p>Linux 网络相关命令
可以使用 yum install iperf3 安装这个工具，或者从网站 https://iperf.fr/iperf-download.php 下载
测试 TCP 吞吐量 假设我们要测试 10.1.207.180 和 10.1.207.181 两个服务器之间的带宽
先在其中一台服务器 10.1.207.181 服上启动 iperf3 服务
[root@oss-irms-181 ~]# iperf3 -s -p 5001 ----------------------------------------------------------- Server listening on 5001 ----------------------------------------------------------- 再在另一台机器 10.1.207.180 启动客户端连接服务端 10.1.207.181 测试
[root@oss-irms-180 ~]# iperf3 -c 10.1.207.181 -P 4 -t 30 -i 2 -p 5001 Connecting to host 10.1.207.181, port 5001 [ 4] local 10.1.207.180 port 49244 connected to 10.1.207.181 port 5001 [ 6] local 10.</p>
<a href=/posts/linux/linux-commands-network/ class=read_more>Read more</a></div>
</div>
<div class=post-footer>
<div class=meta>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date> Wed, Oct 2, 2019
</span>
<span class=separator><a class=category href=/categories/linux/>linux</a></span>
<span class=separator><a class=tag href=/tags/linux/>linux</a><a class=tag href=/tags/network/>network</a><a class=tag href=/tags/iperf3/>iperf3</a></span>
</div>
</div>
</div>
</div>
<div class="post .">
<div class=post-title>
<h3><a href=/posts/git/git-reset-head/>Git Reset HEAD</a>
</h3>
</div>
<div class=post-content>
<div class=p_part>
<p>Git 分支非常有用，您可以根据需要创建一个新分支，合并一个分支或删除一个分支。 您可以使用许多 git 命令来管理 git 中的分支。
当您使用 git checkout 分支时，HEAD会指出最后的提交。 简单来说，您可以说 Git HEAD 是当前分支。 每当您签出一个分支或创建一个新分支时，Git HEAD 都会转移它。
HEAD 是对当前检出分支中最后一次提交的引用。
在存储库中，HEAD 始终指向当前分支的起点。 换句话说，HEAD 是指向下一个提交的父对象或下一个提交将发生的地方的指针。
更具体地说，HEAD 是一个移动指针，它可以引用或可以不引用当前分支，但是它始终引用当前提交。
什么是 HEAD^ 插入符（^）是 Commit 的父级。
什么是 HEAD~ 代字号（〜）是一行几个字符（^）的简写字符。
HEAD〜2 与 HEAD ^^ 的作用相同。
如果写数字，则使用的默认值为1，因此 HEAD〜 等价于 HEAD ^。
如何检查HEAD的状态 您可以使用以下命令查看当前 Git HEAD 指向的位置：
$ cat .git/HEAD ref: refs/heads/master 并且，你可以使用以下命令查看指向 HEAD 的 commit 的 Hash ID：
$ git rev-parse --short HEAD 6f975a5 Detached HEAD HEAD 是您目前的工作分支。 当您尝试 git checkout 分支时，HEAD 指向该分支的顶部，这样您就可以继续工作而没有任何困难。</p>
<a href=/posts/git/git-reset-head/ class=read_more>Read more</a></div>
</div>
<div class=post-footer>
<div class=meta>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date> Tue, Aug 6, 2019
</span>
<span class=separator><a class=category href=/categories/git/>git</a></span>
<span class=separator><a class=tag href=/tags/git/>git</a></span>
</div>
</div>
</div>
</div>
<div class="post .">
<div class=post-title>
<h3><a href=/posts/git/git-command-revert/>Git Revert</a>
</h3>
</div>
<div class=post-content>
<div class=p_part>
<p>撤销上一次提交
$ git revert HEAD 撤销上两次提交
ISSUE-4 解决网关服务日志中无法正确显示经过代理访问的请求端 IP 问题 $ git revert [倒数第一个提交] [倒数第二个提交] </p>
</div>
</div>
<div class=post-footer>
<div class=meta>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date> Tue, Aug 6, 2019
</span>
<span class=separator><a class=category href=/categories/git/>git</a></span>
<span class=separator><a class=tag href=/tags/git/>git</a></span>
</div>
</div>
</div>
</div>
<div class="post .">
<div class=post-title>
<h3><a href=/posts/java/java-jvm-options/>Important JVM Options</a>
</h3>
</div>
<div class=post-content>
<div class=p_part>
<p>Heap Memory -XX:MetaspaceSize Metaspace 空间初始大小，如果不设置的话，默认是20.79M。这个初始大小是触发首次 Metaspace Full GC 的阈值，例如 -XX:MetaspaceSize=128M
-XX:MaxMetaspaceSize Metaspace 最大值，默认不限制大小，但是线上环境建议设置，例如 -XX:MaxMetaspaceSize=512M
GC -Xnoclassgc 表示关闭JVM对类的垃圾回收，缺省情况下，当一个类没有任何活动实例时，JVM 就会从内存中卸装该类，但是这样会使性能下降。如果关闭类垃圾回收，就可以消除由于多次装入和卸装同一个类而造成的开销
-XX:+UseParNewGC 设置年轻代为并行收集
-XX:MaxTenuringThreshold 控制新生代需要经历多少次GC​晋升到老年代中的最大阈值，默认值 15
-XX:+CMSParallelRemarkEnabled CMS收集算法步骤如下：初始标记 -> 并发标记 -> 重新标记 -> 标记清除。 其中 初始标记和重新标记都需要STW，即暂停用户线程。 CMSParallelRemarkEnabled参数可以让重新标记阶段进行并行重新标记，减少暂停时间
-XX:SurvivorRatio 设置 Eden、S0、S1 分配比例，默认值是 8
-XX:SurvivorRatio=5 表示 Eden 占 50%，S0、S1 平分剩余空间
-XX:+UseCompressedOops In short, don&rsquo;t turn it on, use a version which has it on by default.
https://stackoverflow.com/questions/11054548/what-does-the-usecompressedoops-jvm-flag-do-and-when-should-i-use-it
-XX:+DisableExplicitGC 禁止 System.gc() 触发 GC 操作，当没有开启 DisableExplicitGC 这个参数时,你会发现JVM每个小时会执行一次Full GC,这是因为JVM在做分布式GC,为RMI服务的, 可以通过 sun.</p>
<a href=/posts/java/java-jvm-options/ class=read_more>Read more</a></div>
</div>
<div class=post-footer>
<div class=meta>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date> Tue, Aug 6, 2019
</span>
<span class=separator><a class=category href=/categories/java/>java</a></span>
<span class=separator><a class=tag href=/tags/jvm/>jvm</a></span>
</div>
</div>
</div>
</div>
<div class="post .">
<div class=post-title>
<h3><a href=/posts/linux/linux-commands-disk/>Linux Command - Disk</a>
</h3>
</div>
<div class=post-content>
<div class=p_part>
<p>Linux 磁盘相关命令
磁盘IO dd [root@localhost ~]# dd if=/dev/zero of=./a.dat bs=8K count=1M conv=fdatasync 记录了8192+0 的读入 记录了8192+0 的写出 8589934592字节(8.6 GB)已复制，14.8606 秒，578 MB/秒 [root@localhost ~]# dd if=./a.dat of=/dev/null bs=1M count=8k iflag=direct 记录了8192+0 的读入 记录了8192+0 的写出 8589934592字节(8.6 GB)已复制，14.2462 秒，603 MB/秒 磁盘空间 df 查看磁盘各个分区的空间大小、占用、可用等信息
$ df -h Filesystem Size Used Avail Capacity iused ifree %iused Mounted on /dev/disk1s5 466Gi 10Gi 128Gi 8% 488463 4881964417 0% / devfs 192Ki 192Ki 0Bi 100% 663 0 100% /dev /dev/disk1s1 466Gi 318Gi 128Gi 72% 4557528 4877895352 0% /System/Volumes/Data /dev/disk1s4 466Gi 8.</p>
<a href=/posts/linux/linux-commands-disk/ class=read_more>Read more</a></div>
</div>
<div class=post-footer>
<div class=meta>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date> Mon, May 6, 2019
</span>
<span class=separator><a class=category href=/categories/linux/>linux</a></span>
<span class=separator><a class=tag href=/tags/linux/>linux</a><a class=tag href=/tags/disk/>disk</a></span>
</div>
</div>
</div>
</div>
<div class="post .">
<div class=post-title>
<h3><a href=/posts/git/git-commands/>Git Commands</a>
</h3>
</div>
<div class=post-content>
<div class=p_part>
<p>常用 Git 命令
Init 在已有目录中初始化 GIT 仓库
$ git init $ git remote add origin &lt;仓库地址> $ git add . $ git commit -m "Initial commit" $ git push -u origin master Branch 创建分支
git checkout -b &lt;分支名> 推送分支
git push origin &lt;分支名> 修改分支名
git branch -m &lt;旧分支名> &lt;新分支名> 删除本地分支
git branch -D &lt;分支名> 删除远程分支
git push origin --delete &lt;分支名> 拉取远程分支
git fetch origin &lt;分支名> 拉取远程分支并切换
git checkout -b &lt;分支名> origin/&lt;分支名> 当前分支会退到指定版本</p>
<a href=/posts/git/git-commands/ class=read_more>Read more</a></div>
</div>
<div class=post-footer>
<div class=meta>
<div class=info>
<em class="fas fa-calendar-day"></em>
<span class=date> Sat, Apr 6, 2019
</span>
<span class=separator><a class=category href=/categories/git/>git</a></span>
<span class=separator><a class=tag href=/tags/git/>git</a></span>
</div>
</div>
</div>
</div>
<div class=pagination>
<ul class="pagination pagination-default">
<li class=page-item>
<a href=/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a>
</li>
<li class=page-item>
<a href=/page/3/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a>
</li>
<li class=page-item>
<a href=/ aria-label="Page 1" class=page-link role=button>1</a>
</li>
<li class=page-item>
<a href=/page/2/ aria-label="Page 2" class=page-link role=button>2</a>
</li>
<li class=page-item>
<a href=/page/3/ aria-label="Page 3" class=page-link role=button>3</a>
</li>
<li class="page-item active">
<a aria-current=page aria-label="Page 4" class=page-link role=button>4</a>
</li>
<li class=page-item>
<a href=/page/5/ aria-label="Page 5" class=page-link role=button>5</a>
</li>
<li class=page-item>
<a href=/page/5/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a>
</li>
<li class=page-item>
<a href=/page/5/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a>
</li>
</ul>
</div>
</div>
</div>
</div>
<script type=text/javascript src=/js/medium-zoom.min.2d6fd0be87fa98f0c9b4dc2536b312bbca48757f584f6ea1f394abc9bcc38fbc.js integrity="sha256-LW/Qvof6mPDJtNwlNrMSu8pIdX9YT26h85SrybzDj7w=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css integrity=sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js integrity=sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js integrity=sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v crossorigin=anonymous onload=renderMathInElement(document.body)></script></body>
</html>