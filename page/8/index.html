<!doctype html><html lang=en data-theme><head><title>Lei Zhang </title><meta charset=utf-8><meta name=generator content="Hugo 0.120.2"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=description content="This is my knowledge base. I document things here"><link rel=stylesheet href=/css/style.min.7cf3c5090ac13256a5fa5531e5649cfe5a2ba7de88dca14ce0b6e253409a3511.css integrity="sha256-fPPFCQrBMlal+lUx5WSc/lorp96I3KFM4LbiU0CaNRE=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS+yuWSR4=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/custom.min.3fa691134fafa8351e9d193939a352647c1ae886828bdefa3f5a272653dbf7e4.css integrity="sha256-P6aRE0+vqDUenRk5OaNSZHwa6IaCi976P1onJlPb9+Q=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin=anonymous><link rel="shortcut icon" href=/favicons/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicons/favicon-16x16.png><link rel=canonical href=/><link rel=alternate type=application/rss+xml href=/index.xml title><script type=text/javascript src=/js/anatole-header.min.df804b63b5bd8474ea0756ea874bc8f1e92552708cc6ea43aa0d76981dc419f9.js integrity="sha256-34BLY7W9hHTqB1bqh0vI8eklUnCMxupDqg12mB3EGfk=" crossorigin=anonymous></script><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="This is my knowledge base. I document things here"></head><body><div class="sidebar ."><div class=logo-title><div class=title><img src=/images/profile.jpg alt="profile picture"><h3 title><a href=/>I'm Lei Zhang</a></h3><div class=description><p>This is my knowledge base. I document things here</p></div></div><p><a href=https://github.com/coolbeevip><img src="https://img.shields.io/github/followers/coolbeevip?label=follow&amp;style=social" alt="GitHub coolbeevip"></a>
<img src=https://badges.pufler.dev/commits/all/coolbeevip alt="Commits Badge">
<img src=https://badges.pufler.dev/repos/coolbeevip alt="Repos Badge">
<img src=https://badges.pufler.dev/years/coolbeevip alt="Years Badge"></p></div><ul class=social-links><li><a href=https://github.com/coolbeevip/ rel=me aria-label=GitHub><i class="fab fa-github fa-2x" aria-hidden=true></i></a></li><li><a href=mailto:zhanglei@apache.org rel=me aria-label=e-mail><i class="fas fa-envelope fa-2x" aria-hidden=true></i></a></li></ul><div class=footer><div class=by_farbox>&copy; Lei Zhang 2023</div></div></div><div class=main><div class="page-top ."><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span></a><ul class=nav id=navMenu><li><a class=current href=/ title>Home</a></li><li><a href=/posts title>Blog</a></li><li><a href=/bookmarks title>Bookmarks</a></li><li><a href=/about/ title>About</a></li></ul></div><div class=autopagerize_page_element><div class=content><div class="post ."></div><div class="post ."><div class=post-title><h3><a href=/posts/flyway/java-flyway-merge-script-step/>To roll up Flyway incremental changes into 1 file</a></h3></div><div class=post-content><div class=p_part><p>Flyway 通过 SQL Patch 脚本的方式管理数据库脚本版本，开发一段时间后会积攒大量脚本。当一个版本稳定后我们希望合并成一个全量脚本
1.首先对齐程序与数据库中的脚本版本号 查看程序中脚本版本清单，例如：程序中有三个版本的脚本
V1.0.0.0__init.sql V1.0.0.1__add_user_table.sql V1.0.0.2__modify_user_table.sql 查看数据库中历史版本记录表 (默认是 flyway_schema_history) 中执行过的脚本版本，例如：
versions description script success 1.0.0.0 init.sql V1.0.0.0__init.sql 1 1.0.0.1 add_user_table.sql V1.0.0.1__add_user_table.sql 1 1.0.0.2 modify_user_table V1.0.0.2__modify_user_table.sql 1 这里只摘取了关键字段，你可以看到每个版本都已经执行，并且执行都是成功的 success=1
至此：你已经对齐了程序和数据库中脚本版本号，可以开始准备合并了
2.合并程序中的SQL脚本 合并多个脚本的内容到最大版本号的文件中，例如：将 V1.0.0.0__init.sql, V1.0.0.1__add_user_table.sql, V1.0.0.2__modify_user_table.sql 合并为 V1.0.0.2__init.sql
注意： 不是简单的文件合并，而是最终执行结果的合并
3.重新打包程序 只包含合 V1.0.0.2__init.sql 脚本的程序
4.停止所有老版本的程序 包含 V1.0.0.0__init.sql,V1.0.0.1__add_user_table.sql,V1.0.0.2__modify_user_table.sql 老脚本的程序
5.删除数据库中的版本历史表 默认是 flyway_schema_history
6.重启应用程序 在程序启动时设置基线版本参数为当前版本，设置这个参数的目的是告诉 Flyway 当前已经执行过 1.0.0.2 脚本了。这之前的脚本不要再执行了。
flyway.baseline-version=1.0.0.2 注意： 如果是空库，全新安装程序，那么则不需要设置 flyway.baseline-version 参数
7.结束 查看数据库中历史版本记录表 (默认是 flyway_schema_history) 中执行过的脚本版本，例如：
versions description script success 1.</p><a href=/posts/flyway/java-flyway-merge-script-step/ class=read_more>Read more</a></div></div><div class=post-footer><div class=meta><div class=info><em class="fas fa-calendar-day"></em>
<span class=date>Thu, Nov 29, 2018
</span><span class=separator><a class=category href=/categories/java/>java</a></span>
<span class=separator><a class=tag href=/tags/java/>java</a><a class=tag href=/tags/flyway/>flyway</a></span></div></div></div></div><div class="post ."><div class=post-title><h3><a href=/posts/maven/maven-commands/>Maven Commands</a></h3></div><div class=post-content><div class=p_part><p>常用 Maven 命令
Parameters -D 指定参数，如 -Dmaven.test.skip=true 跳过单元测试； -P 指定 Profile 配置，可以用于区分环境； -e 显示maven运行出错的信息； -o 离线执行命令,即不去远程仓库更新包； -f 强制指定使用 POM 文件，或者包含 POM 文件的目录 -pl 选项后可跟随{groupId}:{artifactId}或者所选模块的相对路径(多个模块以逗号分隔) -am 表示同时处理选定模块所依赖的模块 -amd 表示同时处理依赖选定模块的模块 -rf 表示从指定模块开始继续处理 -N 表示不递归子模块 -X 显示maven允许的debug信息； -U 强制去远程更新 snapshot的插件或依赖，默认每天只更新一次。 &ndash;no-snapshot-updates 禁止更新 snapshot Dependency 显示maven依赖数
mvn dependency:tree 显示maven依赖列表
mvn dependency:list 下载依赖包的源码
mvn dependency:sources Maven Wrapper 自动安装 maven 的包装器（适合不想手动安装Maven的用户），使用插件Maven Wrapper plugin将其自动化安装指定版本的 Maven
mvn -N io.takari:maven:wrapper -Dmaven=3.6.3 这个命令会在你的项目中生成如下文件，请将这些文件与源代码一起管理
mvnw: 这是 Linux Script 可执行文件，用来代替 mvn mvnw.cmd: 这是 Windows Script 可执行文件，用来代替 mvn mvn: 隐藏的文件夹，其中包含Maven Wrapper Java库及其属性文件 首次执行 mvnw 或者 mvnw.</p><a href=/posts/maven/maven-commands/ class=read_more>Read more</a></div></div><div class=post-footer><div class=meta><div class=info><em class="fas fa-calendar-day"></em>
<span class=date>Fri, Nov 23, 2018
</span><span class=separator><a class=category href=/categories/java/>java</a></span>
<span class=separator><a class=tag href=/tags/maven/>maven</a></span></div></div></div></div><div class="post ."><div class=post-title><h3><a href=/posts/stress-testing-host-estimate-with-qps/>Estimate host capacity based on QPS</a></h3></div><div class=post-content><div class=p_part><p>通过单个服务器压测的 QPS 估算需要的服务器数量
已知 QPS 和期望每笔耗时，估算服务器数量 服务器数量 $$ = QPS \div (1000 \div 每笔毫秒) \div 每服务器CPU个数 $$
例如：
QPS：每秒处理3200笔 每笔毫秒：50ms 每个服务器CPU个数：16 服务器数量 $$ 3200_{qps} \div (1000_{ms} \div 50_{ms}) \div 16_{cpu} = 10_{台} $$
已知 QPS 以及服务器数量，估算每笔耗时 每笔耗时毫秒 $$ = 1000 \div ( QPS \div ( 服务器数量 \times 每服务器CPU个数 ) ) $$
例如：
QPS：每秒处理3200笔 服务器数量：10 每服务器CPU个数：16 每笔耗时毫秒 $$ 1000 \div ( 3200 \div ( 10 \times 16 ) ) = 50_{ms}$$</p></div></div><div class=post-footer><div class=meta><div class=info><em class="fas fa-calendar-day"></em>
<span class=date>Wed, Mar 7, 2018
</span><span class=separator><a class=category href=/categories/stress/>stress</a></span>
<span class=separator><a class=tag href=/tags/stress/>stress</a><a class=tag href=/tags/test/>test</a><a class=tag href=/tags/qps/>qps</a></span></div></div></div></div><div class="post ."><div class=post-title><h3><a href=/posts/english/ket-unit3/></a></h3></div><div class=post-content><div class=p_part><p>KET UNIT3 1. Grammar Countable nouns How many 用于询问可数名词的数量 a few 修饰可数名词复数，表肯定意义，有一些，不是那么多; few 表否定意义，几乎没有 quite a few表示不少, 相当多 Uncountable nouns How much 用于问不可数名词的数量 a little 修饰不可数名词，表肯定意义，有一点儿 little 表否定意义，几乎没有 Countable nouns and Uncountable nouns a lot of 很多 no 没有 2. Plurals of nouns 1. 大多数名词在末尾加s：
book-books chair-chairs cat-cats 2. 以s、x、ch、sh、o结尾的名词，在末尾加es：
bus-buses class-classes glass-glasses match-matches watch-watches dish-dishes brush-brushes box-boxes fox-foxes half-halves 但也有例外，如photo-photos 3. 以辅音字母+y结尾的名词，把y变为i，再加es：
fly-flies city-cities baby-babies 4. 以f或fe结尾的名词，大多数情况下变为v，并加es：
leaf-leaves knife-knives wife-wives family-families 5.</p><a href=/posts/english/ket-unit3/ class=read_more>Read more</a></div></div><div class=post-footer><div class=meta><div class=info><em class="fas fa-calendar-day"></em>
<span class=date>Mon, Jan 1, 0001</span></div></div></div></div><div class="post ."><div class=post-title><h3><a href=/posts/english/ket-unit4/></a></h3></div><div class=post-content><div class=p_part><p>KET UNIT4 1. Grammar Present Continuous 现在进行时，句子结构为 主语 + 助动词 "be" + 现在分词（动词-ing 形式）, 例如： I am studying(我正在学习) I am studying for my exam(我正在为考试而学习) She is not working today(她今天不工作) What are you doing(你正在做什么) Present Simple 一般现在时，句子结构为 主语 + 谓语动词 I eat breakfast every day(我每天吃早饭) She does not like coffee(他不喜欢咖啡) Do they play tennis on Sundays?(他们星期日打网球吗) 2. Present participle(动词现在分词) 1. 一般规律：大多数动词的现在分词形式是在动词原形（即第一形式）后加-ing：
play-playing read-reading sing-singing 2. 以不发音的字母 e 结尾的动词，去掉 e，再加-ing：
make-making write-writing dance-dancing 但有一些例外，如 be-being 3.</p><a href=/posts/english/ket-unit4/ class=read_more>Read more</a></div></div><div class=post-footer><div class=meta><div class=info><em class="fas fa-calendar-day"></em>
<span class=date>Mon, Jan 1, 0001</span></div></div></div></div><div class="post ."><div class=post-title><h3><a href=/posts/english/ket-unit5/></a></h3></div><div class=post-content><div class=p_part><p>KET UNIT5 1. Grammar 完成练习册 P20-21 阅读、语法部分
2. Passages 熟读学生用书 P37 短文-Joanna Middleton-a young gymnast. 课文抄写两遍(w1) 熟读学生用书P40语法部分文章- Yusra Mardini，课文抄写两遍。(w2) 学生用书P39 Listening Part4, 5个题目做精听练习。听一句重复一句，听力文本在P159左侧，抄写一遍。(w2) 3. Conversation I &mldr; because &mldr; or I think &mldr; because &mldr;
Q: Which is the most exciting sport?
A1: I think playing football is the most exciting sport because football is the most popular sport in the world. I love watching football match on TV.
Q: How often do you play/go/do it?</p><a href=/posts/english/ket-unit5/ class=read_more>Read more</a></div></div><div class=post-footer><div class=meta><div class=info><em class="fas fa-calendar-day"></em>
<span class=date>Mon, Jan 1, 0001</span></div></div></div></div><div class="post ."><div class=post-title><h3><a href=/posts/english/ket-unit6/></a></h3></div><div class=post-content><div class=p_part><p>KET UNIT6 1. Grammar Somebody have/has to do sth. (某人必须做某事) You have to clean bedroom at weekend.
Somebody don’t/doesn&rsquo;t have/has to do sth. (某人不必做某事) You don’t have to clean bedroom at weekend.
Do/Does somebody have to do sth. (某人必须做某事吗?) Do you have to clean bedroom at weekend?
Key grammar points:
&ldquo;To&rdquo; must be followed by the base form of a verb. When the subject is in the third-person singular, &ldquo;has to do&rdquo; should be used.</p><a href=/posts/english/ket-unit6/ class=read_more>Read more</a></div></div><div class=post-footer><div class=meta><div class=info><em class="fas fa-calendar-day"></em>
<span class=date>Mon, Jan 1, 0001</span></div></div></div></div><div class="post ."><div class=post-title><h3><a href=/posts/english/ket-unit7/></a></h3></div><div class=post-content><div class=p_part><p>KET UNIT7 1. Conversation Hospital is a place where you see the doctor. Church is a building where Christians go to pray. Cinema is a place where you go to see a film. Factory is a place where goods are made. Train station is a place where you catch the train. Hotel is a building for people to stay, usually for a short time, people pay for their rooms and meals.</p><a href=/posts/english/ket-unit7/ class=read_more>Read more</a></div></div><div class=post-footer><div class=meta><div class=info><em class="fas fa-calendar-day"></em>
<span class=date>Mon, Jan 1, 0001</span></div></div></div></div><div class="post ."><div class=post-title><h3><a href=/posts/english/ket-unit8/></a></h3></div><div class=post-content><div class=p_part><p>KET UNIT8 1. Grammar 1.1 Past Continuous (过去进行时)， 表示过去某个时间点或时间段中，正在发生的事情 We were dancing at the party at eight o’clock last night. 过去时间点或时间点段中，两件事同时发生。如： My father was reading while my mother was cooking. 过去进行时可跟一般过去时连用，指某事突然发生在另一件事的进程之中。 When she came into class, her classmates were reading. While her classmates were reading, she came into class. While后面接过去进行时, When后面接一般过去时，这两个词不在句子中同时使用。 When my father left home, I was doing homework. While I was doing homework, my father left home. 1.2 Can/Can’t (能力) Can/Can’t 作为情态动词，跟动词原形连用，表示目前所具备的能力。过去式为 Could/Couldn’t, 表示过去所具备的能力。不论主语是单数还是复数，情态动词本身没有任何变化</p><a href=/posts/english/ket-unit8/ class=read_more>Read more</a></div></div><div class=post-footer><div class=meta><div class=info><em class="fas fa-calendar-day"></em>
<span class=date>Mon, Jan 1, 0001</span></div></div></div></div><div class="post ."><div class=post-title><h3><a href=/posts/english/vocabulary/></a></h3></div><div class=post-content><div class=p_part><p>English 中文 English 中文 subject 学科 portrait 肖像画 Art 美术课 painting 绘画 Biology 生物课 living things 生物 Chemistry 化学课 substances 物质 under different conditions 在不同条件下 English 英语课 dictionary 字典 History 历史课 Egypt-Egyptian 埃及-埃及人 Geography 地理课 nature 自然 climate 气候 Physics 物理课 energy 能量 interaction 相互作用;相互影响 Maths 数学课 Music 音乐课 instrument 乐器 uniform 制服；校服 famous 著名的 modern 现代化的；超前的 funny 有趣的；滑稽的 kind 慈祥的；友善的 strict 严格的 fashionable 流行的；时髦的 traditional 传统的 clothing 服装 explain 解释 .</p><a href=/posts/english/vocabulary/ class=read_more>Read more</a></div></div><div class=post-footer><div class=meta><div class=info><em class="fas fa-calendar-day"></em>
<span class=date>Mon, Jan 1, 0001</span></div></div></div></div><div class=pagination><ul class="pagination pagination-default"><li class=page-item><a href=/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/page/7/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/page/6/ aria-label="Page 6" class=page-link role=button>6</a></li><li class=page-item><a href=/page/7/ aria-label="Page 7" class=page-link role=button>7</a></li><li class="page-item active"><a aria-current=page aria-label="Page 8" class=page-link role=button>8</a></li><li class=page-item><a href=/page/9/ aria-label="Page 9" class=page-link role=button>9</a></li><li class=page-item><a href=/page/9/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/page/9/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></div></div></div><script type=text/javascript src=/js/medium-zoom.min.e1c6918cbaa90022a5612f0bd71c7bf3be6d036614c5729cebfe14f7b91fa4bc.js integrity="sha256-4caRjLqpACKlYS8L1xx7875tA2YUxXKc6/4U97kfpLw=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css integrity=sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js integrity=sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js integrity=sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v crossorigin=anonymous onload=renderMathInElement(document.body)></script></body></html>