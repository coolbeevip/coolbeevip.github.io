<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>collect on</title><link>https://coolbeevip.github.io/tags/collect/</link><description>Recent content in collect on</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 07 Nov 2022 13:24:14 +0800</lastBuildDate><atom:link href="https://coolbeevip.github.io/tags/collect/index.xml" rel="self" type="application/rss+xml"/><item><title>Linux Command - Supervisory</title><link>https://coolbeevip.github.io/posts/linux/linux-collect-system/</link><pubDate>Mon, 07 Nov 2022 13:24:14 +0800</pubDate><guid>https://coolbeevip.github.io/posts/linux/linux-collect-system/</guid><description>定时收集当前用户的CPU和内存利用率 创建如下 user_usage.sh
#!/usr/bin/bash echo -e TIME\\tCPU%\\tMEM% while true do top -b -n 1 -u &amp;#34;$user&amp;#34; | awk -v user=&amp;#34;$user&amp;#34; -v date=&amp;#34;$(date &amp;#39;+%Y/%m/%d %H:%M:%S&amp;#39;)&amp;#34; &amp;#39;NR&amp;gt;7 { cpu_utilization_sum += $9; mem_utilization_sum += $10;} END { printf &amp;#34;%s\t%.2f\t%.2f\n&amp;#34;,date,cpu_utilization_sum,mem_utilization_sum; }&amp;#39; sleep $1 done 每 3 秒采集一次
sh user_usage.sh 3 TIME CPU% MEM% 2023/01/06 17:26:56 64.80 82.10 2023/01/06 17:26:57 70.60 82.10 2023/01/06 17:26:58 393.60 82.10 2023/01/06 17:26:59 137.50 82.20 定时收集某个进程的CPU和内存利用率 创建如下 proc_usage.sh
#!/usr/bin/bash echo proc $2 echo -e TIME\\tCPU%\\tMEM% while true do top -b -n 1 -p `ps -ef | grep $2 | grep -v grep | awk &amp;#39;{ print $2 }&amp;#39; | paste -s -d &amp;#39;,&amp;#39;` | awk -v user=&amp;#34;$user&amp;#34; -v date=&amp;#34;$(date &amp;#39;+%Y/%m/%d %H:%M:%S&amp;#39;)&amp;#34; &amp;#39;NR&amp;gt;7 { cpu_utilization_sum += $9; mem_utilization_sum += $10;} END { printf &amp;#34;%s\t%.</description></item></channel></rss>